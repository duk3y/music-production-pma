{% extends 'base.html' %}

{% block title %}
  {{ project.name }} - Project Homepage
{% endblock %}

{% block content %}
  <div class="container-fluid" style="height: 100%;">
    <div class="row">
      <!-- Project Overview Section -->
      <div class="col-md-12 px-4">
        <div class="text-center my-4 p-4">
          <h1>{{ project.name }}</h1>
        </div>
      </div>

      <!-- File Management Section (Left) -->
      <div class="col-md-6 d-flex align-items-center px-4">
        <div class="table-responsive w-100">
          <h2>{{ project.name }} Files</h2>
          <table class="table table-dark table-striped">
            <thead>
              <tr>
                <th>File Name</th>
                <th>Uploaded By</th>
                <th>Uploaded Date</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
                {% for file in project.projectfiles_set.all %}
                <tr>
                  <td>{{ file.title }}</td>
                  <td>{{ file.uploaded_by }}</td>
                  <td>{{ file.created_at }}</td>
                  <td><p>delete</p></td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan="5" class="text-center">No files found.</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>

          <!-- Add Files Button -->
          <div class="text-center mt-3">
            <a href="{% url 'file_upload' project.id %}" class="btn btn-primary">Add Files</a>
          </div>
        </div>
      </div>

      <!-- Right Section with Project Deadlines and Progress Tracking -->
      <div class="col-md-6 px-4">
        <!-- Project Deadlines Section -->
        <div class="text-center mb-4 px-4">
          <h2>Project Deadlines</h2>
          <ul class="list-group">
            {% for deadline in project.deadlines %}
              <li class="list-group-item bg-dark text-light">{{ deadline.name }} - Due: {{ deadline.due_date }}</li>
            {% empty %}
              <li class="list-group-item bg-dark text-light text-center">No deadlines set.</li>
            {% endfor %}
          </ul>
        </div>

        <!-- Progress Tracking Section -->
        <div class="text-center px-4">
          <h2>Progress Tracking</h2>
          <ul class="list-group">
            {% for milestone in project.milestones %}
              <li class="list-group-item bg-dark text-light">{{ milestone.name }} - Status: {{ milestone.status }}</li>
            {% empty %}
              <li class="list-group-item bg-dark text-light text-center">No milestones set.</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <!-- Discussion and Comments Section -->
    <div class="row mt-4">
      <div class="col-md-12 p-4">
        <div class="text-center p-4">
          <h2>Discussion and Comments</h2>
          <div class="comment-section bg-dark p-3">
            {% for comment in project.comments %}
              <div class="comment my-2">
                <p>
                  <strong>{{ comment.user }}:</strong> {{ comment.text }}
                </p>
                <small class="text-muted">Posted on: {{ comment.date }}</small>
              </div>
            {% empty %}
              <p class="text-center">No comments yet. Be the first to start the discussion!</p>
            {% endfor %}
            <form method="post" action="{% url 'add_comment' project.id %}">
              {% csrf_token %}
              <div class="input-group mt-3">
                <input type="text" name="comment" class="form-control" placeholder="Add a comment..." />
                <button type="submit" class="btn btn-light">Post</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
